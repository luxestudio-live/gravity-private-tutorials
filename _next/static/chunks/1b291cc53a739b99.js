(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,11741,e=>{"use strict";let t=(0,e.i(10965).default)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);e.s(["Trash2",()=>t],11741)},54210,29439,e=>{"use strict";var t=e.i(10965);let a=(0,t.default)("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);e.s(["Edit2",()=>a],54210);let s=(0,t.default)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>s],29439)},24865,e=>{"use strict";var t=e.i(68519),a=e.i(29511),s=e.i(58138),r=e.i(76009),l=e.i(91432);e.i(19678);var d=e.i(46805),o=e.i(11741),i=e.i(54210),c=e.i(29439);let n=t.default.env.NEXT_PUBLIC_CLOUDINARY_CLOUD_NAME,m=t.default.env.NEXT_PUBLIC_CLOUDINARY_API_KEY;function b(){let{user:e,loading:t}=(0,l.useAuth)(),[b,x]=(0,s.useState)([]),[p,u]=(0,s.useState)(""),[h,g]=(0,s.useState)(""),[v,y]=(0,s.useState)("Featured"),[f,j]=(0,s.useState)([]),[N,S]=(0,s.useState)(!0),[w,k]=(0,s.useState)(!1),[R,C]=(0,s.useState)(null),[A,T]=(0,s.useState)({name:"",score:"",rank:"",school:"",college:"",standard:"",image:""}),[E,P]=(0,s.useState)(!1),[D,z]=(0,s.useState)(!1),[_,Y]=(0,s.useState)(null),[O,U]=(0,s.useState)(!1),[I,q]=(0,s.useState)({above90:"",above85:"",above80:"",successRate:""}),[M,L]=(0,s.useState)({total:"",above90:"",above85:"",above80:"",passRate:""}),[F,$]=(0,s.useState)({total:"",above90:"",above75:"",passRate:""});(0,s.useEffect)(()=>{t||e||console.warn("User not authenticated")},[e,t]),(0,s.useEffect)(()=>{B()},[]);let B=async()=>{try{S(!0);let e=new Set;(await (0,d.getDocs)((0,d.collection)(r.db,"toppers"))).forEach(t=>{let a=t.data();a.academicYear&&e.add(a.academicYear)}),(await (0,d.getDocs)((0,d.collection)(r.db,"resultsPages"))).forEach(t=>{e.add(t.id)});let t=Array.from(e).sort().reverse();x(t),t.length>0&&u(t[0])}catch(e){console.error("Error fetching academic years:",e)}finally{S(!1)}};(0,s.useEffect)(()=>{p&&(H(),K())},[p,v]);let H=async()=>{try{let e=(0,d.query)((0,d.collection)(r.db,"toppers"),(0,d.where)("academicYear","==",p),(0,d.where)("category","==",v)),t=(await (0,d.getDocs)(e)).docs.map(e=>({id:e.id,...e.data()}));j(t)}catch(e){console.error("Error fetching toppers:",e)}},K=async()=>{if(p)try{U(!0);let e=(0,d.doc)(r.db,"resultsPages",p),t=await (0,d.getDoc)(e),a=t.exists()?t.data():null;Y(a);let s=a?.highlights||[];q({above90:s.find(e=>e.label.includes("Above 90"))?.value?.toString()||"",above85:s.find(e=>e.label.includes("Above 85"))?.value?.toString()||"",above80:s.find(e=>e.label.includes("Above 80"))?.value?.toString()||"",successRate:s.find(e=>e.label.toLowerCase().includes("success rate"))?.value?.toString()||""});let l=a?.statistics?.["10th"]||{},o=a?.statistics?.["12th"]||{};L({total:l.total?.toString()||"",above90:l.above90?.toString()||"",above85:l.above85?.toString()||"",above80:l.above80?.toString()||"",passRate:l.passRate?.toString()||""}),$({total:o.total?.toString()||"",above90:o.above90?.toString()||"",above75:o.above75?.toString()||"",passRate:o.passRate?.toString()||""})}catch(e){console.error("Error fetching page meta:",e)}finally{U(!1)}},V=async()=>{let e=h.trim();if(e&&!b.includes(e)){try{await (0,d.setDoc)((0,d.doc)(r.db,"resultsPages",e),{highlights:[],featuredToppers:[],sscToppers:[],commerceToppers:[],scienceToppers:[],statistics:{}})}catch(e){console.error("Error creating year doc:",e),alert("Could not create academic year: "+e.message);return}x([...b,e].sort().reverse()),u(e),g("")}},X=async()=>{if(!p)return void alert("Select an academic year first");try{U(!0);let e=[{label:"Students Above 90%",value:I.above90||"0",category:"SSC Toppers"},{label:"Students Above 85%",value:I.above85||"0",category:"SSC Results"},{label:"Students Above 80%",value:I.above80||"0",category:"Overall Excellence"},{label:"Success Rate",value:I.successRate||"0%",category:"Pass Percentage"}],t={"10th":{total:M.total||"",above90:M.above90||"",above85:M.above85||"",above80:M.above80||"",passRate:M.passRate||""},"12th":{total:F.total||"",above90:F.above90||"",above75:F.above75||"",passRate:F.passRate||""}},a=(0,d.doc)(r.db,"resultsPages",p),s=_||{};await (0,d.setDoc)(a,{...s,highlights:e,statistics:t}),alert("Overview saved"),Y({...s,highlights:e,statistics:t})}catch(e){console.error("Error saving overview:",e),alert("Failed to save overview: "+e.message)}finally{U(!1)}},W=async e=>{if(confirm(`Delete academic year ${e} and all its data? This cannot be undone.`))try{try{await (0,d.deleteDoc)((0,d.doc)(r.db,"resultsPages",e))}catch(e){console.warn("No resultsPages doc for this year")}let t=(0,d.query)((0,d.collection)(r.db,"toppers"),(0,d.where)("academicYear","==",e)),a=(await (0,d.getDocs)(t)).docs.map(e=>(0,d.deleteDoc)(e.ref));await Promise.all(a);let s=b.filter(t=>t!==e);x(s),p===e&&u(s.length>0?s[0]:""),alert(`Academic year ${e} deleted successfully`)}catch(e){console.error("Error deleting year:",e),alert("Error deleting year: "+e.message)}},G=async t=>{if(t.preventDefault(),!e)return void alert("You must be logged in to add toppers");if(!A.name.trim())return void alert("Name is required");if(!A.score.trim())return void alert("Score is required");if(!A.rank.trim())return void alert("Rank is required");if(!p)return void alert("Please select an academic year");if(!v)return void alert("Please select a category");P(!0);try{console.log("User authenticated:",e.email),console.log("Adding topper with data:",{academicYear:p,category:v,...A});let t={academicYear:p,category:v,...A};R?(console.log("Updating topper:",R),await (0,d.updateDoc)((0,d.doc)(r.db,"toppers",R),t),C(null),alert("Topper updated successfully!")):(console.log("Adding new topper"),await (0,d.addDoc)((0,d.collection)(r.db,"toppers"),t),alert("Topper added successfully!")),T({name:"",score:"",rank:"",school:"",college:"",standard:"",image:""}),k(!1),await H()}catch(e){console.error("Error adding topper:",e),alert("Error: "+(e.message||"Unknown error occurred"))}finally{P(!1)}},J=async e=>{if(confirm("Are you sure?"))try{await (0,d.deleteDoc)((0,d.doc)(r.db,"toppers",e)),await H()}catch(e){console.error("Error deleting topper:",e)}},Q=async e=>{let t=e.target.files?.[0];if(!t)return;P(!0);let a=new FormData;a.append("file",t),a.append("upload_preset","gallery_uploads"),a.append("cloud_name",n),a.append("api_key",m);try{let e=await fetch(`https://api.cloudinary.com/v1_1/${n}/image/upload`,{method:"POST",body:a}),t=await e.json();t.secure_url&&(T({...A,image:t.secure_url}),console.log("Image uploaded successfully:",t.secure_url))}catch(e){console.error("Image upload failed:",e),alert("Failed to upload image")}finally{P(!1)}};return(0,a.jsxs)("div",{className:"py-4 md:py-6 lg:py-4",children:[(0,a.jsx)("h1",{className:"text-2xl md:text-4xl font-bold mb-4 md:mb-6",children:"Results Management"}),(0,a.jsxs)("div",{className:"bg-card border border-border rounded-xl p-4 md:p-8 mb-6 md:mb-8",children:[(0,a.jsx)("h2",{className:"text-lg md:text-xl font-bold mb-4 md:mb-6",children:"Step 1: Academic Year"}),(0,a.jsxs)("div",{className:"mb-4 md:mb-6 p-3 md:p-4 bg-muted/50 rounded-lg",children:[(0,a.jsx)("label",{className:"block text-xs md:text-sm font-medium mb-2 md:mb-3",children:"Create New Academic Year"}),(0,a.jsxs)("div",{className:"flex gap-2 flex-col sm:flex-row",children:[(0,a.jsx)("input",{type:"text",value:h,onChange:e=>g(e.target.value),placeholder:"e.g., 2026-2027",style:{flex:1,padding:"0.5rem 0.75rem",border:"1px solid #d1d5db",borderRadius:"0.375rem",fontSize:"0.875rem"},className:"md:text-base"}),(0,a.jsx)("button",{onClick:V,className:"px-4 md:px-6 py-2 bg-primary text-white rounded-lg hover:bg-primary/90 transition-colors font-medium text-sm md:text-base whitespace-nowrap",children:"Create"})]})]}),b.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs md:text-sm font-medium mb-2 md:mb-3",children:"Select Academic Year"}),(0,a.jsx)("div",{className:"flex gap-2 md:gap-3 flex-wrap items-center",children:b.map(e=>(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)("button",{onClick:()=>u(e),className:`px-3 md:px-6 py-1.5 md:py-2 rounded-lg font-medium transition-all text-sm md:text-base ${p===e?"bg-primary text-white":"bg-muted hover:bg-muted/80"}`,children:e}),(0,a.jsx)("button",{onClick:()=>W(e),className:"p-1 md:p-1.5 text-destructive hover:bg-destructive/10 rounded transition-colors",title:"Delete this academic year",children:(0,a.jsx)(o.Trash2,{className:"w-3 md:w-4 h-3 md:h-4"})})]},e))})]}),0===b.length&&(0,a.jsx)("p",{className:"text-muted-foreground text-xs md:text-sm",children:"No academic years yet. Create one above to get started."})]}),p&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"bg-card border border-border rounded-xl p-4 md:p-8 mb-6 md:mb-8",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4 md:mb-6 gap-4 flex-wrap",children:[(0,a.jsx)("h2",{className:"text-lg md:text-xl font-bold",children:"Step 2: Overview (Highlights & Stats)"}),(0,a.jsx)("button",{onClick:X,disabled:O,className:"px-3 md:px-4 py-1.5 md:py-2 bg-primary text-white rounded-lg hover:bg-primary/90 disabled:opacity-60 text-sm md:text-base whitespace-nowrap",children:O?"Saving...":"Save Overview"})]}),(0,a.jsxs)("div",{className:"grid md:grid-cols-2 gap-4 md:gap-6",children:[(0,a.jsxs)("div",{className:"p-3 md:p-4 border border-border rounded-lg bg-muted/30",children:[(0,a.jsx)("h3",{className:"font-semibold mb-3 md:mb-4 text-sm md:text-base",children:"Highlights"}),(0,a.jsx)("div",{className:"space-y-2 md:space-y-3",children:[{label:"Students Above 90%",key:"above90"},{label:"Students Above 85%",key:"above85"},{label:"Students Above 80%",key:"above80"},{label:"Success Rate (%)",key:"successRate"}].map(e=>(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs md:text-sm font-medium mb-1",children:e.label}),(0,a.jsx)("input",{type:"text",value:I[e.key],onChange:t=>q({...I,[e.key]:t.target.value}),placeholder:e.label,style:{width:"100%",padding:"0.5rem 0.65rem",border:"1px solid #d1d5db",borderRadius:"0.375rem",fontSize:"0.85rem",boxSizing:"border-box"},className:"md:text-base"})]},e.key))})]}),(0,a.jsxs)("div",{className:"p-4 border border-border rounded-lg bg-muted/30",children:[(0,a.jsx)("h3",{className:"font-semibold mb-4",children:"Performance Overview"}),(0,a.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("div",{className:"text-sm font-semibold",children:"10th Standard"}),[{label:"Total Students",key:"total"},{label:"Above 90%",key:"above90"},{label:"Above 85%",key:"above85"},{label:"Above 80%",key:"above80"},{label:"Pass Rate (%)",key:"passRate"}].map(e=>(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-medium mb-1 text-muted-foreground",children:e.label}),(0,a.jsx)("input",{type:"text",value:M[e.key],onChange:t=>L({...M,[e.key]:t.target.value}),placeholder:e.label,style:{width:"100%",padding:"0.55rem",border:"1px solid #d1d5db",borderRadius:"0.375rem",fontSize:"0.9rem",boxSizing:"border-box"}})]},e.key))]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("div",{className:"text-sm font-semibold",children:"11th & 12th"}),[{label:"Total Students",key:"total"},{label:"Above 90%",key:"above90"},{label:"Above 75%",key:"above75"},{label:"Pass Rate (%)",key:"passRate"}].map(e=>(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-medium mb-1 text-muted-foreground",children:e.label}),(0,a.jsx)("input",{type:"text",value:F[e.key],onChange:t=>$({...F,[e.key]:t.target.value}),placeholder:e.label,style:{width:"100%",padding:"0.55rem",border:"1px solid #d1d5db",borderRadius:"0.375rem",fontSize:"0.9rem",boxSizing:"border-box"}})]},e.key))]})]})]})]})]}),(0,a.jsxs)("div",{className:"bg-card border border-border rounded-xl p-8 mb-8",children:[(0,a.jsx)("h2",{className:"text-xl font-bold mb-6",children:"Step 3: Select Category"}),(0,a.jsx)("label",{className:"block text-sm font-medium mb-3",children:"Category"}),(0,a.jsx)("div",{className:"flex gap-3 flex-wrap",children:["Featured","SSC","Commerce","Science"].map(e=>(0,a.jsx)("button",{onClick:()=>y(e),className:`px-6 py-2 rounded-lg font-medium transition-all ${v===e?"bg-accent text-white":"bg-muted hover:bg-muted/80"}`,children:e},e))})]}),(0,a.jsx)("div",{className:"flex justify-end mb-8",children:(0,a.jsxs)("button",{onClick:()=>{w&&(C(null),T({name:"",score:"",rank:"",school:"",college:"",standard:"",image:""})),k(!w)},className:"inline-flex items-center gap-2 px-6 py-3 bg-primary text-white rounded-lg hover:bg-primary/90 transition-colors font-medium",children:[(0,a.jsx)(c.Plus,{className:"w-5 h-5"}),w?"Cancel":"Add Topper"]})}),w&&(0,a.jsxs)("div",{className:"bg-card border border-border rounded-xl p-4 md:p-8 mb-6 md:mb-8",children:[(0,a.jsxs)("h2",{className:"text-xl md:text-2xl font-bold mb-4 md:mb-6",children:[R?"Edit Topper":"Add New Topper"," - ",p," (",v,")"]}),(0,a.jsxs)("form",{onSubmit:G,className:"space-y-4 md:space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs md:text-sm font-medium mb-2",children:"Profile Image (Optional)"}),(0,a.jsxs)("div",{className:"flex gap-2 md:gap-3 items-end flex-wrap",children:[(0,a.jsx)("input",{type:"file",accept:"image/*",onChange:Q,disabled:E,className:"flex-1 min-w-0 text-xs md:text-sm"}),A.image&&(0,a.jsx)("img",{src:A.image,alt:"preview",className:"w-16 md:w-20 h-16 md:h-20 rounded object-cover"})]}),A.image&&(0,a.jsxs)("p",{className:"text-xs md:text-sm text-muted-foreground mt-2",children:["Image uploaded: ",A.image.slice(0,50),"..."]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 md:gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs md:text-sm font-medium mb-2",children:"Name *"}),(0,a.jsx)("input",{type:"text",value:A.name,onChange:e=>T({...A,name:e.target.value}),placeholder:"Student name",required:!0,style:{width:"100%",padding:"0.5rem 0.75rem",border:"1px solid #d1d5db",borderRadius:"0.375rem",fontSize:"0.875rem",boxSizing:"border-box"},className:"md:text-base"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs md:text-sm font-medium mb-2",children:"Score *"}),(0,a.jsx)("input",{type:"text",value:A.score,onChange:e=>T({...A,score:e.target.value}),placeholder:"e.g., 95% or 681/720",required:!0,style:{width:"100%",padding:"0.5rem 0.75rem",border:"1px solid #d1d5db",borderRadius:"0.375rem",fontSize:"0.875rem",boxSizing:"border-box"},className:"md:text-base"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 md:gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs md:text-sm font-medium mb-2",children:"Rank *"}),(0,a.jsx)("input",{type:"text",value:A.rank,onChange:e=>T({...A,rank:e.target.value}),placeholder:"e.g., 1st or AIR - 1499",required:!0,style:{width:"100%",padding:"0.5rem 0.75rem",border:"1px solid #d1d5db",borderRadius:"0.375rem",fontSize:"0.875rem",boxSizing:"border-box"},className:"md:text-base"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs md:text-sm font-medium mb-2",children:"Standard"}),(0,a.jsx)("input",{type:"text",value:A.standard,onChange:e=>T({...A,standard:e.target.value}),placeholder:"e.g., 10th, 12th, NEET-2023",style:{width:"100%",padding:"0.5rem 0.75rem",border:"1px solid #d1d5db",borderRadius:"0.375rem",fontSize:"0.875rem",boxSizing:"border-box"},className:"md:text-base"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 md:gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs md:text-sm font-medium mb-2",children:"School"}),(0,a.jsx)("input",{type:"text",value:A.school,onChange:e=>T({...A,school:e.target.value}),placeholder:"School name",style:{width:"100%",padding:"0.5rem 0.75rem",border:"1px solid #d1d5db",borderRadius:"0.375rem",fontSize:"0.875rem",boxSizing:"border-box"},className:"md:text-base"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs md:text-sm font-medium mb-2",children:"College"}),(0,a.jsx)("input",{type:"text",value:A.college,onChange:e=>T({...A,college:e.target.value}),placeholder:"College name",style:{width:"100%",padding:"0.5rem 0.75rem",border:"1px solid #d1d5db",borderRadius:"0.375rem",fontSize:"0.875rem",boxSizing:"border-box"},className:"md:text-base"})]})]}),(0,a.jsx)("button",{type:"submit",disabled:E,style:{width:"100%",padding:"0.75rem",background:"#3b82f6",color:"#fff",borderRadius:"0.375rem",fontWeight:"500",border:"none",cursor:E?"not-allowed":"pointer",opacity:E?.7:1},className:"text-sm md:text-base",children:E?"Saving...":R?"Update Topper":"Add Topper"})]})]}),(0,a.jsxs)("div",{className:"bg-card border border-border rounded-xl overflow-hidden",children:[(0,a.jsx)("div",{className:"p-6 border-b border-border",children:(0,a.jsxs)("h3",{className:"text-lg font-bold",children:["Toppers - ",p," (",v,")"]})}),0===f.length?(0,a.jsxs)("div",{className:"p-8 text-center text-muted-foreground",children:["No toppers added for ",p," - ",v," yet"]}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{className:"bg-muted",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-4 text-left text-sm font-semibold",children:"Name"}),(0,a.jsx)("th",{className:"px-6 py-4 text-left text-sm font-semibold",children:"Score"}),(0,a.jsx)("th",{className:"px-6 py-4 text-left text-sm font-semibold",children:"Rank"}),(0,a.jsx)("th",{className:"px-6 py-4 text-left text-sm font-semibold",children:"Details"}),(0,a.jsx)("th",{className:"px-6 py-4 text-right text-sm font-semibold",children:"Actions"})]})}),(0,a.jsx)("tbody",{children:f.map(e=>(0,a.jsxs)("tr",{className:"border-t border-border hover:bg-muted/50",children:[(0,a.jsx)("td",{className:"px-6 py-4 font-medium",children:e.name}),(0,a.jsx)("td",{className:"px-6 py-4 font-semibold text-primary",children:e.score}),(0,a.jsx)("td",{className:"px-6 py-4",children:(0,a.jsx)("span",{className:"px-3 py-1 bg-accent/20 text-accent rounded-full text-sm font-medium",children:e.rank})}),(0,a.jsx)("td",{className:"px-6 py-4 text-sm text-muted-foreground",children:e.standard||e.school||e.college||"-"}),(0,a.jsxs)("td",{className:"px-6 py-4 text-right space-x-2",children:[(0,a.jsx)("button",{onClick:()=>{T({name:e.name,score:e.score,rank:e.rank,school:e.school||"",college:e.college||"",standard:e.standard||"",image:e.image||""}),C(e.id),k(!0)},className:"p-2 hover:bg-primary/10 rounded transition-colors inline-block",title:"Edit",children:(0,a.jsx)(i.Edit2,{className:"w-4 h-4"})}),(0,a.jsx)("button",{onClick:()=>J(e.id),className:"p-2 hover:bg-destructive/10 rounded transition-colors text-destructive inline-block",title:"Delete",children:(0,a.jsx)(o.Trash2,{className:"w-4 h-4"})})]})]},e.id))})]})})]})]})]})}e.s(["default",()=>b])}]);